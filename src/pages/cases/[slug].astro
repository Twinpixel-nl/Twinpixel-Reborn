---
// src/pages/cases/[slug].astro
import BaseLayout from "../../layouts/BaseLayout.astro";
import { cases } from "../../data/cases.js";

export function getStaticPaths() {
  return cases.map((c) => ({
    params: { slug: c.slug },
    props: { c },
  }));
}

const { c } = Astro.props;

// Strakke, dunne SVG iconen
const icons: { [key: string]: string } = {
  plus: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>`,
  users: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>`,
  chart: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"></polyline><polyline points="16 7 22 7 22 13"></polyline></svg>`,
  external: `<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>`,
};
---

<BaseLayout title={`Twinpixel | ${c.title}`} description={c.description}>
  
  <!-- DYNAMISCHE CLEAN SCROLLBAR -->
  <style is:global define:vars={{ projectAccent: c.accent }}>
    /* Breedte van de scrollbar (lekker smal) */
    ::-webkit-scrollbar {
      width: 6px;
    }

    /* Achtergrond van de scrollbar (onzichtbaar/matcht bg) */
    ::-webkit-scrollbar-track {
      background: #05060a;
    }

    /* De 'thumb' (het bewegende deel) */
    ::-webkit-scrollbar-thumb {
      background: var(--projectAccent);
      border-radius: 20px;
    }

    /* Voor Firefox */
    html {
      scrollbar-width: thin;
      scrollbar-color: var(--projectAccent) #05060a;
    }
  </style>

  <!-- Hero Section -->
  <section class="hero" style={`--accent:${c.accent};`}>
    <div class="container">
      <nav class="meta-nav">
        <a href="/cases">Projecten</a> / <span>{c.title}</span>
      </nav>
      <h1 class="h1">{c.title}</h1>
      <p class="lead">{c.description}</p>
      
      {c.website && (
        <a href={c.website} target="_blank" class="live-link">
          Bekijk de website <span class="icon-arrow" set:html={icons.external} />
        </a>
      )}
    </div>
  </section>

  <!-- Content & Sidebar Section -->
  <section class="case-details" style={`--accent:${c.accent};`}>
    <div class="container grid">
      
      <div class="main-content">
        <!-- Main Image -->
        <div class="image-frame">
          <img src={c.image} alt={c.title} />
        </div>

        <div class="content-sections">
          
          <!-- HET VERHAAL (Conditioneel) -->
          {c.extra && (
            <div class="text-block highlight-block">
              <span class="label">Het verhaal</span>
              <h2>Achter de schermen</h2>
              <div class="extra-text-card">
                <p>{c.extra}</p>
              </div>
            </div>
          )}

          <div class="text-block">
            <span class="label">De Uitdaging</span>
            <h2>Vraagstuk</h2>
            <p>{c.challenge}</p>
          </div>

          <div class="text-block">
            <span class="label">De Aanpak</span>
            <h2>Strategie & Realisatie</h2>
            <div class="approach-cards">
              {c.overview.map(item => (
                <div class="approach-item">
                  <h3>{item.title}</h3>
                  <p>{item.desc}</p>
                </div>
              ))}
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar -->
      <aside class="sidebar">
        <!-- Impact Stats -->
        <div class="glass-card">
          <span class="label">Impact</span>
          <div class="stats-list">
            {c.stats.map(stat => (
              <div class="stat-box">
                <div class="stat-icon" style={`color: ${c.accent}`} set:html={icons[stat.icon]} />
                <div>
                  <div class="stat-val">{stat.value}</div>
                  <div class="stat-lab">{stat.label}</div>
                </div>
              </div>
            ))}
          </div>
        </div>

        <!-- Resultaat Kaart -->
        <div class="glass-card outcome-card">
          <span class="label">Eindresultaat</span>
          <p>{c.outcome}</p>
        </div>

        <!-- Meta Info -->
        <div class="glass-card info-card">
          <div class="info-row"><span>Klant</span> {c.client}</div>
          <div class="info-row"><span>Jaar</span> {c.year}</div>
          <div class="info-row tags-row">
            {c.tags.map(tag => <span class="mini-tag">{tag}</span>)}
          </div>
        </div>
      </aside>

    </div>
  </section>
</BaseLayout>

<style>
  /* --- HERO SECTIE --- */
  .hero { padding: 120px 0 60px; }
  .meta-nav { font-size: 13px; color: rgba(255,255,255,0.3); margin-bottom: 24px; text-transform: uppercase; letter-spacing: 1px; }
  .meta-nav a { color: inherit; text-decoration: none; transition: 0.2s; }
  .meta-nav a:hover { color: var(--accent); }

  .h1 { font-size: clamp(40px, 7vw, 64px); font-weight: 700; margin: 0 0 20px; letter-spacing: -0.02em; }
  .lead { font-size: 20px; color: rgba(255,255,255,0.6); max-width: 600px; line-height: 1.5; margin-bottom: 32px; }

  .live-link {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    color: #fff;
    text-decoration: none;
    font-weight: 500;
    padding-bottom: 4px;
    border-bottom: 1px solid rgba(255,255,255,0.1);
    transition: 0.3s;
  }
  .live-link:hover { border-color: var(--accent); color: var(--accent); }
  .icon-arrow { width: 14px; height: 14px; }

  /* --- GRID --- */
  .grid {
    display: grid;
    grid-template-columns: 1fr 340px;
    gap: 80px;
    padding-bottom: 100px;
  }

  /* --- MAIN CONTENT --- */
  .image-frame {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    border-radius: 24px;
    padding: 10px;
    margin-bottom: 60px;
  }
  .image-frame img { width: 100%; border-radius: 16px; display: block; }

  .content-sections { display: grid; gap: 80px; }
  .label { font-size: 11px; text-transform: uppercase; letter-spacing: 2px; color: rgba(255,255,255,0.3); font-weight: 600; margin-bottom: 16px; display: block; }
  .text-block h2 { font-size: 28px; font-weight: 600; margin-bottom: 24px; }
  .text-block p { font-size: 18px; line-height: 1.7; color: rgba(255,255,255,0.7); }

  /* --- HET VERHAAL --- */
  .extra-text-card {
    padding: 32px;
    border-radius: 24px;
    border-left: 3px solid var(--accent);
    background: linear-gradient(to right, color-mix(in srgb, var(--accent) 5%, transparent), transparent);
  }
  .extra-text-card p {
    font-size: 20px;
    color: #fff;
    line-height: 1.6;
    margin: 0;
  }

  /* --- AANPAK CARDS --- */
  .approach-cards { display: grid; gap: 20px; margin-top: 32px; }
  .approach-item {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.05);
    padding: 32px;
    border-radius: 20px;
  }
  .approach-item h3 { font-size: 18px; margin-bottom: 10px; font-weight: 600; color: #fff; }
  .approach-item p { font-size: 15px; color: rgba(255,255,255,0.5); margin: 0; line-height: 1.6; }

  /* --- SIDEBAR --- */
  .sidebar { display: flex; flex-direction: column; gap: 24px; }
  
  .glass-card {
    background: rgba(255,255,255,0.02);
    border: 1px solid rgba(255,255,255,0.06);
    border-radius: 24px;
    padding: 32px;
  }

  /* Stats */
  .stats-list { display: grid; gap: 28px; }
  .stat-box { display: flex; align-items: center; gap: 20px; }
  .stat-icon { width: 28px; height: 28px; }
  .stat-val { font-size: 26px; font-weight: 700; color: #fff; line-height: 1; }
  .stat-lab { font-size: 13px; color: rgba(255,255,255,0.4); margin-top: 6px; }

  /* Eindresultaat Kaart */
  .outcome-card {
    border-left: 3px solid var(--accent);
    background: linear-gradient(to right, color-mix(in srgb, var(--accent) 8%, transparent), transparent);
  }
  .outcome-card p { font-size: 16px; line-height: 1.6; color: rgba(255,255,255,0.9); margin: 0; }

  /* Info Meta */
  .info-row { display: flex; justify-content: space-between; padding: 14px 0; border-bottom: 1px solid rgba(255,255,255,0.05); font-size: 14px; color: #fff; }
  .info-row:last-of-type { border-bottom: none; }
  .info-row span { color: rgba(255,255,255,0.4); }
  .tags-row { flex-wrap: wrap; gap: 8px; padding-top: 16px; }
  .mini-tag { font-size: 11px; background: rgba(255,255,255,0.04); padding: 6px 12px; border-radius: 6px; color: rgba(255,255,255,0.6); }

  /* Mobiel */
  @media (max-width: 1024px) {
    .grid { grid-template-columns: 1fr; gap: 60px; }
    .sidebar { order: -1; }
    .hero { padding: 80px 0 40px; }
  }
</style>